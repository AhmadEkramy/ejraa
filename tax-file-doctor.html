<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax File for Doctor - Ejraa</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="shortcut icon" type="image/png" href="logo.png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Tajawal:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top custom-navbar" id="mainNav">
        <div class="container">
            <!-- Logo on the left -->
            <a class="navbar-brand" href="index.html">
                <img src="logo.png" alt="Ejraa Logo" class="navbar-logo">
            </a>
            
            <!-- Navigation in the center (desktop) -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link glow-hover" href="index.html#home" data-en="Home" data-ar="الرئيسية">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link glow-hover" href="index.html#about" data-en="About" data-ar="عن الشركة">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link glow-hover" href="index.html#packages" data-en="Packages" data-ar="الباقات">Packages</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link glow-hover" href="index.html#contact" data-en="Contact" data-ar="تواصل معنا">Contact</a>
                    </li>
                </ul>
            </div>
            
            <!-- Buttons on the right (always visible) -->
            <div class="d-flex align-items-center gap-2">
                <!-- Language Toggle -->
                <button class="custom-lang-btn" id="langToggle">
                    <i class="fas fa-globe"></i>
                    <span id="langText">العربية</span>
                </button>
                
                <!-- Dark Mode Toggle -->
                <button class="custom-dark-btn" id="darkModeToggle">
                    <i class="fas fa-moon" id="darkModeIcon"></i>
                </button>
                
                <!-- Hamburger Menu Button (mobile only) -->
                <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Package Header -->
    <section class="package-header py-5 mt-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="index.html" data-en="Home" data-ar="الرئيسية">Home</a></li>
                            <li class="breadcrumb-item"><a href="index.html#packages" data-en="Packages" data-ar="الباقات">Packages</a></li>
                            <li class="breadcrumb-item active" data-en="Tax File for Doctor" data-ar="الملف الضريبي للطبيب">Tax File for Doctor</li>
                        </ol>
                    </nav>
                    <h1 class="package-title glow-text" data-en="Tax File for Doctor" data-ar="الملف الضريبي للطبيب">Tax File for Doctor</h1>
                    <p class="package-subtitle" data-en="Complete tax registration and compliance services for medical professionals" data-ar="خدمات التسجيل الضريبي والامتثال الكاملة للمهنيين الطبيين">Complete tax registration and compliance services for medical professionals</p>
                    <div class="package-price">
                        <span class="price-label" data-en="Starting from" data-ar="يبدأ من">Starting from</span>
                        <span class="price-amount" data-en="2,500 EGP" data-ar="2,500 جنيه">2,500 EGP</span>
                    </div>
                </div>
                <div class="col-lg-4 text-center">
                    <div class="package-icon-large">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tax File Information -->
    <section class="license-conditions py-5">
        <div class="container">
            <h2 class="section-title text-center mb-5 glow-text" data-en="Tax Card Extraction for Doctors" data-ar="استخراج البطاقة الضريبية للأطباء">Tax Card Extraction for Doctors</h2>
            
            <!-- Introduction -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="definition-card glow-card">
                        <h3 class="card-title" data-en="Introduction" data-ar="مقدمة">Introduction</h3>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            <span data-en="Doctors are classified as freelance professionals, not merchants" data-ar="الأطباء يُصنَّفون كـ أصحاب مهن حرة وليسوا تجارًا">Doctors are classified as freelance professionals, not merchants</span>
                        </div>
                        <p data-en="Therefore, clinics or specialized clinics do not normally issue a commercial register, except in some special tax cases." data-ar="ولذلك لا تُصدر العيادات أو العيادات التخصصية سجل تجاري في الوضع الطبيعي، إلا في بعض الحالات الضريبية الخاصة.">Therefore, clinics or specialized clinics do not normally issue a commercial register, except in some special tax cases.</p>
                    </div>
                </div>
            </div>

            <!-- Required Documents -->
            <div class="row">
                <div class="col-12 mb-4">
                    <div class="conditions-card glow-card">
                        <h3 class="card-title" data-en="Required Documents for Opening Tax File" data-ar="الأوراق المطلوبة لفتح الملف الضريبي">Required Documents for Opening Tax File</h3>
                        <p data-en="To open a tax file and obtain a tax card for the doctor, the following documents are required:" data-ar="لفتح ملف ضريبي والحصول على البطاقة الضريبية للطبيب، يلزم توفير المستندات التالية:">To open a tax file and obtain a tax card for the doctor, the following documents are required:</p>
                        <ol class="conditions-list">
                            <li data-en="Facility registration with the syndicate + (ID card or syndicate membership certificate)" data-ar="تسجيل المنشأة بالنقابة + (كارنيه أو شهادة قيد بالنقابة)">Facility registration with the syndicate + (ID card or syndicate membership certificate)</li>
                            <li data-en="Official power of attorney in case of an agent representing the doctor" data-ar="التوكيل الرسمي في حالة وجود وكيل عن الطبيب">Official power of attorney in case of an agent representing the doctor</li>
                            <li data-en="Rental or ownership contract for the clinic or facility premises" data-ar="عقد إيجار أو تمليك لمقر العيادة أو المنشأة">Rental or ownership contract for the clinic or facility premises</li>
                            <li data-en="Complete doctor's documents" data-ar="أوراق الطبيب كاملة">Complete doctor's documents</li>
                            <li data-en="Short video of the facility (if requested by the Tax Authority to verify activity)" data-ar="فيديو قصير للمنشأة (في حالة طلب مصلحة الضرائب للتأكد من النشاط)">Short video of the facility (if requested by the Tax Authority to verify activity)</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Special Cases -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="specialty-notes glow-card">
                        <h3 class="card-title text-center mb-4" data-en="In Case Doctor Doesn't Own a Clinic or Clinic is Not Licensed" data-ar="في حالة عدم امتلاك الطبيب لعيادة أو عدم ترخيص العيادة">In Case Doctor Doesn't Own a Clinic or Clinic is Not Licensed</h3>
                        <ul class="conditions-list">
                            <li data-en="Obtain a negative certificate from the syndicate" data-ar="يتم استخراج شهادة سلبية من النقابة">Obtain a negative certificate from the syndicate</li>
                            <li data-en="Provide any proof of working in another entity" data-ar="تقديم أي إثبات لمزاولة العمل في جهة أخرى">Provide any proof of working in another entity</li>
                            <li data-en="Or issue a certificate with the syndicate registration date" data-ar="أو إصدار شهادة بتاريخ قيد النقابة">Or issue a certificate with the syndicate registration date</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Important Notes -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="conditions-card glow-card">
                        <h3 class="card-title" data-en="Important Notes" data-ar="ملاحظات هامة">Important Notes</h3>
                        <p data-en="The doctor receives:" data-ar="يحصل الطبيب على:">The doctor receives:</p>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="alert alert-success">
                                    <h6 class="alert-heading" data-en="Tax Card" data-ar="بطاقة ضريبية">Tax Card</h6>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-info">
                                    <h6 class="alert-heading" data-en="Addressed Letter" data-ar="خطاب موجه">Addressed Letter</h6>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-warning">
                                    <h6 class="alert-heading" data-en="Taxpayer Data Document" data-ar="وثيقة بيانات ممول">Taxpayer Data Document</h6>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-primary">
                                    <h6 class="alert-heading" data-en="Income and Expenses Book" data-ar="دفتر إيرادات ومصروفات">Income and Expenses Book</h6>
                                </div>
                            </div>
                        </div>
                        <div class="alert alert-warning mt-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <span data-en="In some special cases, a commercial register may be required, especially if the activity includes additional services or sales alongside medical services." data-ar="في بعض الحالات الخاصة، قد يُطلب سجل تجاري، خاصة إذا كان النشاط يتضمن خدمات أو مبيعات إضافية بجانب الخدمات الطبية.">In some special cases, a commercial register may be required, especially if the activity includes additional services or sales alongside medical services.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Application Form -->
    <section class="application-form py-5 bg-light">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="form-card glow-card">
                        <h2 class="form-title text-center mb-4 glow-text" data-en="Apply for Tax File Service" data-ar="تقدم بطلب خدمة الملف الضريبي">Apply for Tax File Service</h2>
                        <p class="form-subtitle text-center mb-4" data-en="Fill out the form below and we'll contact you within 24 hours" data-ar="املأ النموذج أدناه وسنتواصل معك خلال 24 ساعة">Fill out the form below and we'll contact you within 24 hours</p>
                        
                        <form id="taxDoctorForm" class="package-form">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Full Name *" data-ar="الاسم الكامل *">Full Name *</label>
                                    <input type="text" class="form-control" name="fullName" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Phone Number *" data-ar="رقم الهاتف *">Phone Number *</label>
                                    <input type="tel" class="form-control" name="phone" required>
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label" data-en="Email Address *" data-ar="البريد الإلكتروني *">Email Address *</label>
                                    <input type="email" class="form-control" name="email" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Medical Specialty *" data-ar="التخصص الطبي *">Medical Specialty *</label>
                                    <select class="form-select" name="specialty" required>
                                        <option value="" data-en="Select specialty" data-ar="اختر التخصص">Select specialty</option>
                                        <option value="general" data-en="General Medicine" data-ar="طب عام">General Medicine</option>
                                        <option value="internal" data-en="Internal Medicine" data-ar="باطنة">Internal Medicine</option>
                                        <option value="surgery" data-en="General Surgery" data-ar="جراحة عامة">General Surgery</option>
                                        <option value="pediatrics" data-en="Pediatrics" data-ar="أطفال">Pediatrics</option>
                                        <option value="gynecology" data-en="Gynecology & Obstetrics" data-ar="نساء وتوليد">Gynecology & Obstetrics</option>
                                        <option value="orthopedics" data-en="Orthopedics" data-ar="عظام">Orthopedics</option>
                                        <option value="cardiology" data-en="Cardiology" data-ar="قلب">Cardiology</option>
                                        <option value="dermatology" data-en="Dermatology" data-ar="جلدية">Dermatology</option>
                                        <option value="ophthalmology" data-en="Ophthalmology" data-ar="عيون">Ophthalmology</option>
                                        <option value="ent" data-en="ENT" data-ar="أنف وأذن وحنجرة">ENT</option>
                                        <option value="radiology" data-en="Radiology" data-ar="أشعة">Radiology</option>
                                        <option value="emergency" data-en="Emergency Medicine" data-ar="طوارئ">Emergency Medicine</option>
                                        <option value="other" data-en="Other" data-ar="أخرى">Other</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Practice Type *" data-ar="نوع الممارسة *">Practice Type *</label>
                                    <select class="form-select" name="practiceType" required>
                                        <option value="" data-en="Select practice type" data-ar="اختر نوع الممارسة">Select practice type</option>
                                        <option value="private-clinic" data-en="Private Clinic" data-ar="عيادة خاصة">Private Clinic</option>
                                        <option value="hospital-employee" data-en="Hospital Employee" data-ar="موظف مستشفى">Hospital Employee</option>
                                        <option value="freelance" data-en="Freelance/Consultant" data-ar="عمل حر/استشاري">Freelance/Consultant</option>
                                        <option value="partnership" data-en="Partnership" data-ar="شراكة">Partnership</option>
                                        <option value="multiple" data-en="Multiple Sources" data-ar="مصادر متعددة">Multiple Sources</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Estimated Annual Income *" data-ar="الدخل السنوي المقدر *">Estimated Annual Income *</label>
                                    <select class="form-select" name="annualIncome" required>
                                        <option value="" data-en="Select income range" data-ar="اختر نطاق الدخل">Select income range</option>
                                        <option value="under-100k" data-en="Under 100,000 EGP" data-ar="أقل من 100,000 جنيه">Under 100,000 EGP</option>
                                        <option value="100k-300k" data-en="100,000 - 300,000 EGP" data-ar="100,000 - 300,000 جنيه">100,000 - 300,000 EGP</option>
                                        <option value="300k-500k" data-en="300,000 - 500,000 EGP" data-ar="300,000 - 500,000 جنيه">300,000 - 500,000 EGP</option>
                                        <option value="500k-1m" data-en="500,000 - 1,000,000 EGP" data-ar="500,000 - 1,000,000 جنيه">500,000 - 1,000,000 EGP</option>
                                        <option value="over-1m" data-en="Over 1,000,000 EGP" data-ar="أكثر من 1,000,000 جنيه">Over 1,000,000 EGP</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Current Tax Status *" data-ar="الوضع الضريبي الحالي *">Current Tax Status *</label>
                                    <select class="form-select" name="taxStatus" required>
                                        <option value="" data-en="Select tax status" data-ar="اختر الوضع الضريبي">Select tax status</option>
                                        <option value="not-registered" data-en="Not Registered" data-ar="غير مسجل">Not Registered</option>
                                        <option value="registered-need-help" data-en="Registered but Need Help" data-ar="مسجل لكن أحتاج مساعدة">Registered but Need Help</option>
                                        <option value="non-compliant" data-en="Non-Compliant" data-ar="غير ملتزم">Non-Compliant</option>
                                        <option value="need-update" data-en="Need to Update Information" data-ar="أحتاج تحديث البيانات">Need to Update Information</option>
                                    </select>
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label" data-en="Practice Address *" data-ar="عنوان مكان الممارسة *">Practice Address *</label>
                                    <textarea class="form-control" name="address" rows="3" placeholder="Enter complete address..." required></textarea>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Services Needed *" data-ar="الخدمات المطلوبة *">Services Needed *</label>
                                    <select class="form-select" name="servicesNeeded" required>
                                        <option value="" data-en="Select services" data-ar="اختر الخدمات">Select services</option>
                                        <option value="basic-setup" data-en="Basic Tax File Setup" data-ar="إعداد الملف الضريبي الأساسي">Basic Tax File Setup</option>
                                        <option value="setup-with-vat" data-en="Setup with VAT Registration" data-ar="الإعداد مع تسجيل ضريبة القيمة المضافة">Setup with VAT Registration</option>
                                        <option value="annual-filing" data-en="Annual Tax Return Filing" data-ar="تقديم الإقرار الضريبي السنوي">Annual Tax Return Filing</option>
                                        <option value="full-service" data-en="Full Service Package" data-ar="باقة الخدمة الكاملة">Full Service Package</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label" data-en="Preferred Start Date" data-ar="تاريخ البدء المفضل">Preferred Start Date</label>
                                    <input type="date" class="form-control" name="startDate">
                                </div>
                                <div class="col-12 mb-4">
                                    <label class="form-label" data-en="Additional Notes" data-ar="ملاحظات إضافية">Additional Notes</label>
                                    <textarea class="form-control" name="notes" rows="4" placeholder="Any specific requirements or questions..."></textarea>
                                </div>
                                <div class="col-12 text-center">
                                    <div class="d-flex gap-3 justify-content-center flex-wrap">
                                        <button type="button" class="btn btn-success btn-lg px-4" id="sendWhatsApp">
                                            <i class="fab fa-whatsapp me-2"></i>
                                            <span data-en="Send to WhatsApp" data-ar="إرسال للواتساب">Send to WhatsApp</span>
                                        </button>
                                        <button type="button" class="btn btn-danger btn-lg px-4" id="exportPDF">
                                            <i class="fas fa-file-pdf me-2"></i>
                                            <span data-en="Export as PDF" data-ar="تصدير كـ PDF">Export as PDF</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- WhatsApp Float Button -->
    <div class="whatsapp-float" id="whatsappFloat">
        <a href="https://wa.me/201044273608" target="_blank" class="whatsapp-link">
            <i class="fab fa-whatsapp"></i>
        </a>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jsPDF for PDF export with Arabic support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas for better text rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Custom JS -->
    <script src="main.js"></script>
    
    <script>
        // Function to detect if text contains Arabic characters
        function containsArabic(text) {
            const arabicRegex = /[\u0600-\u06FF\u0750-\u077F]/;
            return arabicRegex.test(text);
        }
        
        // Function to get current language
        function getCurrentLanguage() {
            return document.documentElement.getAttribute('dir') === 'rtl' ? 'ar' : 'en';
        }
        
        // Function to get localized text
        function getLocalizedText(enText, arText) {
            return getCurrentLanguage() === 'ar' ? arText : enText;
        }
        
        // Function to get specialty display text
        function getSpecialtyDisplayText(value) {
            const specialties = {
                'general': { en: 'General Medicine', ar: 'طب عام' },
                'internal': { en: 'Internal Medicine', ar: 'باطنة' },
                'surgery': { en: 'General Surgery', ar: 'جراحة عامة' },
                'pediatrics': { en: 'Pediatrics', ar: 'أطفال' },
                'gynecology': { en: 'Gynecology & Obstetrics', ar: 'نساء وتوليد' },
                'orthopedics': { en: 'Orthopedics', ar: 'عظام' },
                'cardiology': { en: 'Cardiology', ar: 'قلب' },
                'dermatology': { en: 'Dermatology', ar: 'جلدية' },
                'ophthalmology': { en: 'Ophthalmology', ar: 'عيون' },
                'ent': { en: 'ENT', ar: 'أنف وأذن وحنجرة' },
                'radiology': { en: 'Radiology', ar: 'أشعة' },
                'emergency': { en: 'Emergency Medicine', ar: 'طوارئ' },
                'other': { en: 'Other', ar: 'أخرى' }
            };
            
            if (specialties[value]) {
                return getCurrentLanguage() === 'ar' ? specialties[value].ar : specialties[value].en;
            }
            return value;
        }
        
        // Function to get practice type display text
        function getPracticeTypeDisplayText(value) {
            const practiceTypes = {
                'private-clinic': { en: 'Private Clinic', ar: 'عيادة خاصة' },
                'hospital-employee': { en: 'Hospital Employee', ar: 'موظف مستشفى' },
                'freelance': { en: 'Freelance/Consultant', ar: 'عمل حر/استشاري' },
                'partnership': { en: 'Partnership', ar: 'شراكة' },
                'multiple': { en: 'Multiple Sources', ar: 'مصادر متعددة' }
            };
            
            if (practiceTypes[value]) {
                return getCurrentLanguage() === 'ar' ? practiceTypes[value].ar : practiceTypes[value].en;
            }
            return value;
        }
        
        // Function to get income range display text
        function getIncomeDisplayText(value) {
            const incomeRanges = {
                'under-100k': { en: 'Under 100,000 EGP', ar: 'أقل من 100,000 جنيه' },
                '100k-300k': { en: '100,000 - 300,000 EGP', ar: '100,000 - 300,000 جنيه' },
                '300k-500k': { en: '300,000 - 500,000 EGP', ar: '300,000 - 500,000 جنيه' },
                '500k-1m': { en: '500,000 - 1,000,000 EGP', ar: '500,000 - 1,000,000 جنيه' },
                'over-1m': { en: 'Over 1,000,000 EGP', ar: 'أكثر من 1,000,000 جنيه' }
            };
            
            if (incomeRanges[value]) {
                return getCurrentLanguage() === 'ar' ? incomeRanges[value].ar : incomeRanges[value].en;
            }
            return value;
        }
        
        // Function to get tax status display text
        function getTaxStatusDisplayText(value) {
            const taxStatuses = {
                'not-registered': { en: 'Not Registered', ar: 'غير مسجل' },
                'registered-need-help': { en: 'Registered but Need Help', ar: 'مسجل لكن أحتاج مساعدة' },
                'non-compliant': { en: 'Non-Compliant', ar: 'غير ملتزم' },
                'need-update': { en: 'Need to Update Information', ar: 'أحتاج تحديث البيانات' }
            };
            
            if (taxStatuses[value]) {
                return getCurrentLanguage() === 'ar' ? taxStatuses[value].ar : taxStatuses[value].en;
            }
            return value;
        }
        
        // Function to get services needed display text
        function getServicesDisplayText(value) {
            const services = {
                'basic-setup': { en: 'Basic Tax File Setup', ar: 'إعداد الملف الضريبي الأساسي' },
                'setup-with-vat': { en: 'Setup with VAT Registration', ar: 'الإعداد مع تسجيل ضريبة القيمة المضافة' },
                'annual-filing': { en: 'Annual Tax Return Filing', ar: 'تقديم الإقرار الضريبي السنوي' },
                'full-service': { en: 'Full Service Package', ar: 'باقة الخدمة الكاملة' }
            };
            
            if (services[value]) {
                return getCurrentLanguage() === 'ar' ? services[value].ar : services[value].en;
            }
            return value;
        }
        
        // WhatsApp functionality
        document.getElementById('sendWhatsApp').addEventListener('click', function() {
            const form = document.getElementById('taxDoctorForm');
            const formData = new FormData(form);
            
            // Check if required fields are filled
            const requiredFields = ['fullName', 'phone', 'email', 'specialty', 'practiceType', 'annualIncome', 'taxStatus', 'address', 'servicesNeeded'];
            let isValid = true;
            let missingFields = [];
            
            requiredFields.forEach(field => {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    isValid = false;
                    missingFields.push(field);
                }
            });
            
            if (!isValid) {
                const alertMessage = getLocalizedText(
                    'Please fill in all required fields: ' + missingFields.join(', '),
                    'يرجى ملء جميع الحقول المطلوبة: ' + missingFields.join(', ')
                );
                alert(alertMessage);
                return;
            }
            
            // Create WhatsApp message based on current language
            let message;
            if (getCurrentLanguage() === 'ar') {
                message = `*طلب خدمة الملف الضريبي للطبيب*\n\n`;
                message += `*الاسم الكامل:* ${formData.get('fullName')}\n`;
                message += `*رقم الهاتف:* ${formData.get('phone')}\n`;
                message += `*البريد الإلكتروني:* ${formData.get('email')}\n`;
                message += `*التخصص الطبي:* ${getSpecialtyDisplayText(formData.get('specialty'))}\n`;
                message += `*نوع الممارسة:* ${getPracticeTypeDisplayText(formData.get('practiceType'))}\n`;
                message += `*الدخل السنوي المقدر:* ${getIncomeDisplayText(formData.get('annualIncome'))}\n`;
                message += `*الوضع الضريبي الحالي:* ${getTaxStatusDisplayText(formData.get('taxStatus'))}\n`;
                message += `*عنوان مكان الممارسة:* ${formData.get('address')}\n`;
                message += `*الخدمات المطلوبة:* ${getServicesDisplayText(formData.get('servicesNeeded'))}\n`;
                if (formData.get('startDate')) {
                    message += `*تاريخ البدء المفضل:* ${formData.get('startDate')}\n`;
                }
                if (formData.get('notes')) {
                    message += `*ملاحظات إضافية:* ${formData.get('notes')}\n`;
                }
            } else {
                message = `*Tax File for Doctor Application*\n\n`;
                message += `*Full Name:* ${formData.get('fullName')}\n`;
                message += `*Phone Number:* ${formData.get('phone')}\n`;
                message += `*Email:* ${formData.get('email')}\n`;
                message += `*Medical Specialty:* ${getSpecialtyDisplayText(formData.get('specialty'))}\n`;
                message += `*Practice Type:* ${getPracticeTypeDisplayText(formData.get('practiceType'))}\n`;
                message += `*Estimated Annual Income:* ${getIncomeDisplayText(formData.get('annualIncome'))}\n`;
                message += `*Current Tax Status:* ${getTaxStatusDisplayText(formData.get('taxStatus'))}\n`;
                message += `*Practice Address:* ${formData.get('address')}\n`;
                message += `*Services Needed:* ${getServicesDisplayText(formData.get('servicesNeeded'))}\n`;
                if (formData.get('startDate')) {
                    message += `*Preferred Start Date:* ${formData.get('startDate')}\n`;
                }
                if (formData.get('notes')) {
                    message += `*Additional Notes:* ${formData.get('notes')}\n`;
                }
            }
            
            // Encode message for URL
            const encodedMessage = encodeURIComponent(message);
            const whatsappURL = `https://wa.me/201044273608?text=${encodedMessage}`;
            
            // Open WhatsApp
            window.open(whatsappURL, '_blank');
        });
        
        // PDF export functionality
        document.getElementById('exportPDF').addEventListener('click', function() {
            const form = document.getElementById('taxDoctorForm');
            const formData = new FormData(form);
            
            // Check if required fields are filled
            const requiredFields = ['fullName', 'phone', 'email', 'specialty', 'practiceType', 'annualIncome', 'taxStatus', 'address', 'servicesNeeded'];
            let isValid = true;
            let missingFields = [];
            
            requiredFields.forEach(field => {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    isValid = false;
                    missingFields.push(field);
                }
            });
            
            if (!isValid) {
                const alertMessage = getLocalizedText(
                    'Please fill in all required fields: ' + missingFields.join(', '),
                    'يرجى ملء جميع الحقول المطلوبة: ' + missingFields.join(', ')
                );
                alert(alertMessage);
                return;
            }
            
            // Check if content contains Arabic
            const hasArabicContent = containsArabic(formData.get('fullName')) || 
                                   containsArabic(formData.get('address')) || 
                                   containsArabic(formData.get('notes') || '') ||
                                   getCurrentLanguage() === 'ar';
            
            // Create HTML content for PDF
            const title = getLocalizedText('Tax File for Doctor Application', 'طلب خدمة الملف الضريبي للطبيب');
            const fullNameLabel = getLocalizedText('Full Name:', 'الاسم الكامل:');
            const phoneLabel = getLocalizedText('Phone Number:', 'رقم الهاتف:');
            const emailLabel = getLocalizedText('Email:', 'البريد الإلكتروني:');
            const specialtyLabel = getLocalizedText('Medical Specialty:', 'التخصص الطبي:');
            const practiceTypeLabel = getLocalizedText('Practice Type:', 'نوع الممارسة:');
            const incomeLabel = getLocalizedText('Estimated Annual Income:', 'الدخل السنوي المقدر:');
            const taxStatusLabel = getLocalizedText('Current Tax Status:', 'الوضع الضريبي الحالي:');
            const addressLabel = getLocalizedText('Practice Address:', 'عنوان مكان الممارسة:');
            const servicesLabel = getLocalizedText('Services Needed:', 'الخدمات المطلوبة:');
            const startDateLabel = getLocalizedText('Preferred Start Date:', 'تاريخ البدء المفضل:');
            const notesLabel = getLocalizedText('Additional Notes:', 'ملاحظات إضافية:');
            const footerText = getLocalizedText(
                `Generated on: ${new Date().toLocaleDateString()}`,
                `تم الإنشاء في: ${new Date().toLocaleDateString('ar-EG')}`
            );
            
            const htmlContent = `
                <div style="font-family: 'Tajawal', 'Inter', Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; direction: ${hasArabicContent ? 'rtl' : 'ltr'}; text-align: ${hasArabicContent ? 'right' : 'left'};">
                    <h1 style="color: #2c3e50; margin-bottom: 30px; text-align: center; font-size: 24px; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
                        ${title}
                    </h1>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${fullNameLabel}</strong>
                            <span style="color: #34495e;">${formData.get('fullName')}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${phoneLabel}</strong>
                            <span style="color: #34495e;">${formData.get('phone')}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${emailLabel}</strong>
                            <span style="color: #34495e;">${formData.get('email')}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${specialtyLabel}</strong>
                            <span style="color: #34495e;">${getSpecialtyDisplayText(formData.get('specialty'))}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${practiceTypeLabel}</strong>
                            <span style="color: #34495e;">${getPracticeTypeDisplayText(formData.get('practiceType'))}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${incomeLabel}</strong>
                            <span style="color: #34495e;">${getIncomeDisplayText(formData.get('annualIncome'))}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${taxStatusLabel}</strong>
                            <span style="color: #34495e;">${getTaxStatusDisplayText(formData.get('taxStatus'))}</span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: block; margin-bottom: 5px;">${addressLabel}</strong>
                            <div style="color: #34495e; padding: 10px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                                ${formData.get('address').replace(/\n/g, '<br>')}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${servicesLabel}</strong>
                            <span style="color: #34495e;">${getServicesDisplayText(formData.get('servicesNeeded'))}</span>
                        </div>
                        
                        ${formData.get('startDate') ? `
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: inline-block; min-width: 200px;">${startDateLabel}</strong>
                            <span style="color: #34495e;">${formData.get('startDate')}</span>
                        </div>
                        ` : ''}
                        
                        ${formData.get('notes') ? `
                        <div style="margin-bottom: 15px;">
                            <strong style="color: #2c3e50; display: block; margin-bottom: 5px;">${notesLabel}</strong>
                            <div style="color: #34495e; padding: 10px; background: white; border-radius: 4px; border: 1px solid #dee2e6;">
                                ${formData.get('notes').replace(/\n/g, '<br>')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #dee2e6; color: #6c757d; font-size: 12px;">
                        ${footerText}
                    </div>
                </div>
            `;
            
            // Create a temporary div to hold the HTML content
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            tempDiv.style.top = '-9999px';
            tempDiv.style.width = '800px';
            document.body.appendChild(tempDiv);
            
            // Use html2canvas to convert HTML to canvas, then to PDF
            html2canvas(tempDiv, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff',
                width: 800,
                height: tempDiv.scrollHeight
            }).then(canvas => {
                // Remove the temporary div
                document.body.removeChild(tempDiv);
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Calculate dimensions
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                // Add image to PDF
                const imgData = canvas.toDataURL('image/png');
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Add new pages if content is longer than one page
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Save PDF
                const fileName = hasArabicContent ? 
                    `طلب_ملف_ضريبي_طبيب_${formData.get('fullName').replace(/\s+/g, '_')}.pdf` :
                    `Tax_File_Doctor_${formData.get('fullName').replace(/\s+/g, '_')}.pdf`;
                pdf.save(fileName);
            }).catch(error => {
                // Remove the temporary div in case of error
                if (document.body.contains(tempDiv)) {
                    document.body.removeChild(tempDiv);
                }
                console.error('Error generating PDF:', error);
                alert(getLocalizedText(
                    'Error generating PDF. Please try again.',
                    'خطأ في إنشاء ملف PDF. يرجى المحاولة مرة أخرى.'
                ));
            });
        });
    </script>
</body>
</html>